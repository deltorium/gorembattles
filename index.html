<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GOREM TERMINAL</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@400;700&display=swap');

        :root {
            --primary: #00ff88;
            --secondary: #00aaff;
            --bg: #0f0f13;
            --card-bg: #1a1a2e;
            --text: #ffffff;
            --danger: #ff4444;
        }

        body {
            margin: 0;
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Roboto', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        /* HEADER */
        .header {
            background: linear-gradient(180deg, rgba(0,255,136,0.1) 0%, transparent 100%);
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #333;
        }
        .user-avatar {
            width: 80px; height: 80px;
            border-radius: 50%;
            border: 3px solid var(--primary);
            margin: 0 auto 10px;
            background: #333; /* Placeholder */
            display: flex; align-items: center; justify-content: center;
            font-size: 30px;
        }
        .user-name { font-family: 'Orbitron', sans-serif; font-size: 20px; color: var(--primary); }
        .user-firm { font-size: 12px; color: #888; margin-top: 5px; }

        /* STATS GRID */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            padding: 15px;
        }
        .stat-card {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid #333;
            text-align: center;
        }
        .stat-value { font-size: 18px; font-weight: bold; margin-top: 5px; }
        .stat-label { font-size: 12px; color: #aaa; }
        .coin { color: #ffd700; }
        .mtc { color: var(--secondary); }

        /* TABS */
        .tabs {
            display: flex;
            overflow-x: auto;
            padding: 10px;
            gap: 10px;
            border-bottom: 1px solid #333;
        }
        .tab-btn {
            background: transparent;
            border: 1px solid #555;
            color: #fff;
            padding: 8px 16px;
            border-radius: 20px;
            white-space: nowrap;
            cursor: pointer;
            transition: 0.2s;
        }
        .tab-btn.active {
            background: var(--primary);
            color: #000;
            border-color: var(--primary);
            font-weight: bold;
        }

        /* SECTIONS */
        .section { display: none; padding: 15px; padding-bottom: 80px; }
        .section.active { display: block; }
        .section-title { font-family: 'Orbitron', sans-serif; margin-bottom: 15px; border-left: 3px solid var(--primary); padding-left: 10px;}

        /* ACTIONS */
        .action-btn {
            width: 100%;
            padding: 15px;
            margin-bottom: 10px;
            background: var(--card-bg);
            border: 1px solid var(--primary);
            color: white;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            display: flex; justify-content: space-between; align-items: center;
        }
        .action-btn:active { background: var(--primary); color: black; }
        .btn-price { background: rgba(0,0,0,0.5); padding: 2px 8px; border-radius: 5px; font-size: 12px; }

        /* SHOP GRID */
        .shop-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .shop-item {
            background: var(--card-bg); border: 1px solid #444;
            border-radius: 10px; padding: 10px; text-align: center;
        }
        .shop-item img { width: 50px; height: 50px; margin-bottom: 5px; }
        .buy-btn {
            background: var(--secondary); border: none; color: white;
            width: 100%; padding: 8px; border-radius: 5px; margin-top: 5px; cursor: pointer;
        }

        /* CRYPTO INPUT */
        .crypto-input {
            width: 100%; padding: 10px; background: #222; border: 1px solid #555;
            color: white; border-radius: 5px; margin-bottom: 10px; box-sizing: border-box;
        }
        .crypto-actions { display: flex; gap: 10px; }
        .crypto-btn { flex: 1; padding: 10px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; }
        .btn-buy { background: #00ff88; color: black; }
        .btn-sell { background: #ff4444; color: white; }

        /* GAMES LINK */
        .game-card {
            background: linear-gradient(45deg, #2b1055, #7597de);
            padding: 20px; border-radius: 15px;
            text-align: center; margin-bottom: 15px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

    </style>
</head>
<body>

    <div class="header">
        <div class="user-avatar" id="avatar">üë§</div>
        <div class="user-name" id="username">Loading...</div>
        <div class="user-firm" id="firm">–ù–µ—Ç —Ñ–∏—Ä–º—ã</div>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-label">–ë–∞–ª–∞–Ω—Å</div>
            <div class="stat-value coin"><span id="balance">0</span> ü™ô</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">–ö—Ä–∏–ø—Ç–æ</div>
            <div class="stat-value mtc"><span id="crypto">0</span> MTC</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">–ö–∞—Ä—Ç—ã</div>
            <div class="stat-value"><span id="cards">0</span> üÉè</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Wipes</div>
            <div class="stat-value"><span id="wipes">0</span> ‚ò¢Ô∏è</div>
        </div>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('main')">–ì–ª–∞–≤–Ω–∞—è</button>
        <button class="tab-btn" onclick="switchTab('shop')">–ú–∞–≥–∞–∑–∏–Ω</button>
        <button class="tab-btn" onclick="switchTab('crypto')">–ë–∏—Ä–∂–∞</button>
        <button class="tab-btn" onclick="switchTab('games')">–ò–≥—Ä—ã</button>
    </div>

    <!-- MAIN TAB -->
    <div id="main" class="section active">
        <h2 class="section-title">–î–µ–π—Å—Ç–≤–∏—è</h2>
        <button class="action-btn" onclick="sendAction('farm')">
            ‚õèÔ∏è –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –§–∞—Ä–º
            <span class="btn-price">FREE</span>
        </button>
        <button class="action-btn" onclick="tg.close()">
            ‚ùå –ó–∞–∫—Ä—ã—Ç—å
        </button>
    </div>

    <!-- SHOP TAB -->
    <div id="shop" class="section">
        <h2 class="section-title">–ö–µ–π—Å—ã</h2>
        <div class="shop-grid">
            <div class="shop-item">
                <div style="font-size:30px">üì¶</div>
                <div>Common</div>
                <div style="font-size:12px; color:#aaa">50 ü™ô</div>
                <button class="buy-btn" onclick="buyCase('common')">–ö—É–ø–∏—Ç—å</button>
            </div>
            <div class="shop-item">
                <div style="font-size:30px">üü¶</div>
                <div>Rare</div>
                <div style="font-size:12px; color:#aaa">150 ü™ô</div>
                <button class="buy-btn" onclick="buyCase('rare')">–ö—É–ø–∏—Ç—å</button>
            </div>
            <div class="shop-item">
                <div style="font-size:30px">üü™</div>
                <div>Premium</div>
                <div style="font-size:12px; color:#aaa">300 ü™ô</div>
                <button class="buy-btn" onclick="buyCase('premium')">–ö—É–ø–∏—Ç—å</button>
            </div>
            <div class="shop-item">
                <div style="font-size:30px">üüß</div>
                <div>Mythic</div>
                <div style="font-size:12px; color:#aaa">1000 ü™ô</div>
                <button class="buy-btn" onclick="buyCase('mythic')">–ö—É–ø–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- CRYPTO TAB -->
    <div id="crypto-tab" class="section">
        <h2 class="section-title">MTC Exchange</h2>
        <input type="number" id="crypto-amount" class="crypto-input" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ">
        <div class="crypto-actions">
            <button class="crypto-btn btn-buy" onclick="tradeCrypto('buy')">–ö–£–ü–ò–¢–¨</button>
            <button class="crypto-btn btn-sell" onclick="tradeCrypto('sell')">–ü–†–û–î–ê–¢–¨</button>
        </div>
        <p style="font-size: 12px; color: #888; margin-top: 10px;">–ö—É—Ä—Å –º–µ–Ω—è–µ—Ç—Å—è –≤ –±–æ—Ç–µ. –ó–¥–µ—Å—å –±—ã—Å—Ç—Ä–∞—è —Å–¥–µ–ª–∫–∞.</p>
    </div>

    <!-- GAMES TAB -->
    <div id="games" class="section">
        <h2 class="section-title">–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</h2>
        <div class="game-card" onclick="location.href='game.html'"> <!-- –°–°–´–õ–ö–ê –ù–ê –¢–í–û–Æ –ò–ì–†–£ -->
            <div style="font-size: 40px;">‚öîÔ∏è</div>
            <h3>GOREM BATTLES</h3>
            <p>–ö–∞—Ä—Ç–æ—á–Ω–∞—è –±–∏—Ç–≤–∞ —Å –ê–ª–µ–∫—Å–µ–µ–º</p>
        </div>
        <div class="game-card" style="background: linear-gradient(45deg, #550000, #aa0000);" onclick="sendAction('roulette')">
            <div style="font-size: 40px;">üî´</div>
            <h3>–†—É–ª–µ—Ç–∫–∞</h3>
            <p>–†–∏—Å–∫–Ω–∏ –≤—Å–µ–º (–≤ —á–∞—Ç–µ)</p>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö –∏–∑ URL (–∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞–ª –±–æ—Ç)
        const urlParams = new URLSearchParams(window.location.search);
        const dataParam = urlParams.get('data');
        
        if (dataParam) {
            try {
                const userData = JSON.parse(decodeURIComponent(dataParam)); // –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ JSON.parse –µ—Å–ª–∏ –Ω–µ —ç–Ω–∫–æ–¥–∏–ª–∏
                document.getElementById('username').innerText = userData.name;
                document.getElementById('avatar').innerText = userData.name[0];
                document.getElementById('balance').innerText = userData.bal;
                document.getElementById('crypto').innerText = userData.mtc;
                document.getElementById('cards').innerText = userData.inv_count;
                document.getElementById('wipes').innerText = userData.wf;
                document.getElementById('firm').innerText = userData.firm !== "–ù–µ—Ç" ? "üè¢ " + userData.firm : "–ë–µ–∑—Ä–∞–±–æ—Ç–Ω—ã–π";
            } catch (e) {
                console.error("Error parsing data", e);
            }
        }

        function switchTab(tabId) {
            document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            
            // –§–∏–∫—Å ID –¥–ª—è –∫—Ä–∏–ø—Ç—ã
            const realId = tabId === 'crypto' ? 'crypto-tab' : tabId;
            document.getElementById(realId).classList.add('active');
            
            // –ù–∞—Ö–æ–¥–∏–º –∫–Ω–æ–ø–∫—É –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º
            event.target.classList.add('active');
        }

        function sendAction(actionName) {
            tg.sendData(JSON.stringify({ action: actionName }));
            tg.close(); // –ó–∞–∫—Ä—ã–≤–∞–µ–º, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–µ–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —á–∞—Ç–µ
        }

        function buyCase(type) {
            tg.sendData(JSON.stringify({ action: 'buy_case', type: type }));
            tg.close();
        }

        function tradeCrypto(op) {
            const amount = document.getElementById('crypto-amount').value;
            if(!amount || amount <= 0) {
                tg.showAlert("–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ!");
                return;
            }
            tg.sendData(JSON.stringify({ action: 'exchange', op: op, amount: amount }));
            tg.close();
        }
    </script>
</body>
</html>
